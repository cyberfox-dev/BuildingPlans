<app-nav-menu></app-nav-menu>


<ng-template #MFTModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">New Note For Mobile Field Tracking</h4>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <div class="modal-body">
    <form>

      <mat-form-field class="example-full-width">
        <mat-label>Type A Note</mat-label>
        <input matInput [(ngModel)]="mftNote" id="mftNote" name="mftNote" (keyup)="onCheckMFTNote($event)">
      </mat-form-field>
      <p *ngIf="showUpload === false "><strong>* Note </strong> : <em>You must type a note in order to upload a file</em> </p>
      <mat-form-field>
        <div>

          <input matInput [(ngModel)]="fileAttrs" readonly name="name" placeholder="Select An Image" />

          <mat-toolbar *ngIf="showUpload">
            <div class="row" style="margin-bottom:15px;">
              <div class="container-fluid">
                <ng-container>
                  <app-file-upload [ApplicationID]="ApplicationID"
                                   [UploadFor]="fileAttrsName"
                                   [isStatusOfWork]="true"
                                   [MftNote]="mftNote"
                                   (passFileName)="onPassFileName($event)"
                                   (onUploadFinished)="onFileDelete($event, 0)"
                                   (onUploadSuccess)="onFileUpload($event)"></app-file-upload>
                </ng-container>

              </div>
            </div>
          </mat-toolbar>
        </div>
      </mat-form-field>


    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-success" (click)="saveNote();modal.close('Save click')">Save</button>
  </div>
</ng-template>



<h1 *ngIf="CurrentApplicationBeingViewed[0].isPlanning === false" class="animationSlideUp">Application Information</h1>
<h1 *ngIf="CurrentApplicationBeingViewed[0].isPlanning === true" class="animationSlideUp">Application Planning Information</h1>
<h2 class="animationSlideUp">Project Number {{projectNo}}</h2>
<div>
  <h3 *ngIf="fromReApplyArchive == true" style="color:deeppink;">The applicant has reapplied, you're currently looking at an older version of their application</h3>
</div>
<div class="cont1" *ngIf="fromReApplyArchive == false">

  <app-action-center [ApplicationID]="ApplicationID" (refreshParent)="ngOnInit()" *ngIf="isInternalUser && InternalExternalUser == false" (optionEvent)="reciveOption($event)" class="animationSlideUp"></app-action-center>
  <button mat-button color="action" [matMenuTriggerFor]="actions" class="animationSlideUp"> <img src="assets/fontawesome-free-6.4.2-web/svgs/regular/ellipsis-vertical-solid.svg" class="icon"></button>
  <mat-menu #actions="matMenu">
    <button mat-menu-item (click)="openPaidDate(paidDateModal)" *ngIf="EMB"> Move to Paid</button>
    <!--<button mat-menu-item (click)="MoveToNextStage()" *ngIf="isInternalUser">Move to Next Stage</button>-->
    <!--<button mat-menu-item (click)="MoveToNextStage()"><img src="assets/fontawesome-free-6.4.2-web/svgs/regular/ban-solid.svg" class="icon"> Cancel Application</button>--><!--reapply Sindiswa 22 January 2023-->
    <button mat-menu-item (click)=" moveToClosed()"><img src="assets/fontawesome-free-6.4.2-web/svgs/regular/ban-solid.svg" class="icon"> Cancel Application</button>
    <button mat-menu-item (click)="goToNewWayleave(true)" *ngIf="canReapply"><img src="assets/fontawesome-free-6.4.2-web/svgs/regular/arrow-rotate-right-solid.svg" class="icon"> Re-apply</button>
    <!--<button mat-menu-item (click)="validate()"><i class="fa fa-repeat" aria-hidden="true"></i> Test BP</button>-->


  </mat-menu>

</div>

<div class="cont7">
  <button mat-raised-button color="generatePackBtn" (click)="OpenLoadingModal()" *ngIf="generateApprovalbtn">Generate My Approval Pack</button>

  
</div>



<div class="container-fluid cont6 animationFadeIn">
  <!--  Progess bar Kyle 07-02-24-->
  <div class="cont8">
  <div class="progress-bar-container" *ngIf="CurrentApplicationBeingViewed[0].CurrentStageName == 'Department Distribution'">
    <div class="progress-text" [@countUp]="progressBar">Distribution Stage Progress {{progressBar}}%</div>
    <div class="progress-bar" [style.--progressBar]="progressBar + '%'">
    </div>
  </div>

    </div>



  <!--  Progess bar Kyle 07-02-24-->
  <mat-tab-group>

    <!--------------------------------------------------------Project Information  *ngIf="generateApprovalbtn"--------------------------------------------------->

    <mat-tab label="Project Information">

      <app-view-project-details></app-view-project-details>
      <!--<nav class="menu">
        <input type="checkbox" href="#" class="menu-open" name="menu-open" id="menu-open" />
        <label class="menu-open-button" for="menu-open">
          <span class="hamburger hamburger-1"></span>
          <span class="hamburger hamburger-2"></span>
          <span class="hamburger hamburger-3"></span>
        </label>

        <a class="menu-item" matTooltipPosition="left" matTooltip="Show applicant layer"> <i class="fa fa-user"></i> </a>
        <a class="menu-item" matTooltipPosition="left" matTooltip="Show department layer"><i class="fa fa-building"></i> </a>
        <a class="menu-item" matTooltipPosition="left" matTooltip="Show all layers"> <i class="fa fa-eye"></i> </a>
        <a class="menu-item" matTooltipPosition="left" matTooltip="Hide all layers"> <i class="fa fa-eye-slash"></i> </a>


      </nav>-->
      <!--<div class="maps">
        <iframe src="https://www.google.com/maps/embed?pb=!1m14!1m12!1m3!1d55522.617408819875!2d30.405427199999995!3d-29.569843200000005!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sen!2sza!4v1662643454248!5m2!1sen!2sza" width="100%" height="700" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
      </div>-->
      <app-project-details-map-view [data]="ARCGISAPIData"></app-project-details-map-view>
      <app-department-circulation></app-department-circulation>
      <!-- <app-department-circulation-planning *ngIf="CurrentApplicationBeingViewed[0].isPlanning === true"></app-department-circulation-planning>-->
    </mat-tab>


    <!--------------------------------------------------------Comments--------------------------------------------------->


    <mat-tab label="Comments">



      <!--//JJS 8 Jan (Changed the approve to Prov.Approve)-->
      <div class="main-container">
        <section id="timeline" class="timeline-outer">
          <div class="container" id="content">

            <div class="row" *ngFor="let commentsList of CommentsList; let i = index" [style.margin-left.px]="(i % 2 === 0) ? 60 : 80" [style.margin-right.px]="(i % 2 === 0) ? 60 : 80">
              <div class="col s12 m12 l12" *ngIf="!(commentsList.CommentStatus === 'Referred' && referComment)">
                <!---Change Wording Kyle 15/01/24-->
                <ul class="timeline" [class.approve]="commentsList.CommentStatus === 'Provisionally Approved'||commentsList.CommentStatus === 'Approved(Conditional)' " [class.finalApprove]="commentsList.CommentStatus === 'FinalApproved' || commentsList.CommentStatus === 'Final Approved'|| commentsList.CommentStatus === 'Complete' " [class.Reject]="commentsList.CommentStatus === 'FinalReject'||commentsList.CommentStatus === 'Rejected'||commentsList.CommentStatus === 'Provisionally Rejected'|| commentsList.CommentStatus === 'Final Rejected' " [class.clarify]="commentsList.CommentStatus === 'Clarify' || commentsList.CommentStatus === 'Clarified'|| commentsList.CommentStatus === 'Reviewer Clarify' || commentsList.CommentStatus == 'Applicant Clarify' || commentsList.CommentStatus ==='Applicant Clarified'" [class.reviewerClarify]="commentsList.CommentStatus === 'Reviewer Clarified' || commentsList.CommentStatus === 'Reviewer Clarity'" [class.refer]="commentsList.CommentStatus === 'Referred'" [class.returned]="commentsList.CommentStatus === 'Returned'">

                  <li class="event" data-date="">

                    <!---Comments Kyle 01/02/24 -->
                    <h3>{{commentsList.SubDepartmentName}}({{commentsList.ZoneName}}) - {{commentsList.CommentStatus}}</h3>

                    <h5 *ngIf="isInternalUser && InternalExternalUser == false">{{commentsList.UserName}}</h5>
                    <br />
                    <div class="cont2">
                      <div [innerHTML]="sanitizeHTML(commentsList.Comment)"></div>
                      <button mat-raised-button color="blue" *ngIf="commentsList.CommentStatus != 'FinalApproved'  &&   CurrentUserProfile[0].subDepartmentName === commentsList.SubDepartmentName && commentsList.UserName === this.CurrentUser.fullName" (click)="openEditCommentModal(commentEditorModal, i)">Edit Comment</button>

                    </div>

                    <!--<p>

                      {{commentsList.Comment}}
                    </p>-->

                    <br />

                    <br />

                    <h6>{{commentsList.DateCreated}}</h6>
                    <br />

                    <!--Applicant Clarity-->
                    <button mat-raised-button color="clarify" *ngIf=" (commentsList.CommentStatus === 'Clarify' && canClarify) || (commentsList.CommentStatus === 'Reviewer Clarity' && canReviewerClarify )|| (commentsList.CommentStatus === 'Reviewer Clarify' || commentsList.CommentStatus === 'Applicant Clarify' && canClarify)" (click)="openReplyModal(replyModal,i,'Reply', commentsList.CommentStatus)">Reply</button>
                    <button mat-raised-button color="clarify" *ngIf="(commentsList.CommentStatus === 'Clarified' && canClarify) || ( commentsList.CommentStatus === 'Reviewer Clarified' && canReviewerClarify) || (canClarify && commentsList. isApplicantReplay !== null)" (click)="openReplyModal(replyModal,i, 'Update', commentsList.CommentStatus)">Update Reply</button>
                    <div class="row" *ngIf=" commentsList.HasReply === true && commentsList.isApplicantReplay != null">
                      <label *ngIf="(commentsList.CommentStatus === 'Clarified' || commentsList.CommentStatus === 'Applicant Clarified') && commentsList.isApplicantReplay != null"> <strong><em>Applicant's Reply:</em></strong></label>
                      <label *ngIf="commentsList.CommentStatus === 'Reviewer Clarified' && commentsList.isApplicantReplay != null"> <strong><em>Reviewer's Reply:</em></strong></label>
                      <div class="form-floating mb-3 mt-3" *ngIf="commentsList.HasReply === true && commentsList.isApplicantReplay != null">
                        <!--<input type="text" class="form-control" value="{{commentsList.isApplicantReplay}}" id="ApplicantReply" name="ApplicantReply" disabled> [(ngModel)]="ApplicantReply">-->

                        <div class="disabled-textbox" [innerHTML]="sanitizeHTML(commentsList.isApplicantReplay)" id="ApplicantReply"></div>

                      </div>
                    </div>

                  </li>

                </ul>
              </div>
            </div>
          </div>

        </section>

        <br />
      </div>
      <!-- <div class="cont3" *ngIf="isInternalUser">
        <button mat-raised-button color="green" (click)="onCreateApprovalPack()" *ngIf="ApprovalPackBtn">Approval Pack</button>
        <button mat-raised-button color="red" (click)="onCrreateRejectionPack()" *ngIf="RejectionPackBtn">Rejection Pack</button>
      </div>-->

      <div class="container-fluid" *ngIf="rejected">
        <div class="alert alert-danger">
          <h4>Your application has been rejected, Please reffer to the Rejection pack located in the documents tab.</h4>
        </div>
      </div>
      <div class="container-fluid " *ngIf="approved">
        <div class="alert alert-success">
          <h4>Your application has been approved, Please reffer to the approval pack located in the documents tab.</h4>
        </div>
      </div>

      <!--<mat-form-field>
      <div>
        <mat-toolbar>-->
      <!-- Display files names -->
      <!--<input matInput [(ngModel)]="fileAttr" readonly name="name" />-->
      <!-- Browse Button -->
      <!--<button mat-flat-button color="blue">Browse File</button>
      </mat-toolbar>-->
      <!-- Fetch selected filed on change -->
      <!--<input type="file"
                 #fileInput
                 id="uploadFile"
                 (change)="uploadFileEvt($event)"
                 name="uploadFile"
                 multiple="multiple"
                 accept="image/*" />
        </div>
      </mat-form-field>-->


    </mat-tab>
    <!--USE THE QUILL-EDITOR!!-->
    <!--This is the modal for when the applicant can reply to a comment made by the line department-->
    <ng-template #replyModal let-modal>
      <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">{{ modalTitle }}</h4>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
      </div>
      <div class="modal-body">
        <form>
          <div class="row">

            <div class="form-floating mb-3 mt-3">
              <input type="text" class="form-control" [(ngModel)]="reply" id="reply" name="reply" placeholder="Edit Comment">
              <label for="reply">Enter in a reply</label>
            </div>

          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-success" (click)="createReply();modal.close('Save click')">Save</button>
      </div>
    </ng-template>


    <!--this is the modal for when the line dep user wants to edit their comment made -->
    <ng-template #commentEditorModal let-modal>
      <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Update Your Comment</h4>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
      </div>
      <div class="modal-body">
        <form>


          <div class="row">

            <div class="form-floating mb-3 mt-3">
              <input type="text" [(ngModel)]="commentEdit" name="commentEdit" class="form-control" id="commentEdit" placeholder="Update Comment">


              <!--<label for="commentEdit">Update Comment</label>-->
            </div>

          </div>


        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-success" (click)="updateComment();modal.close('Save click')">Save</button>
      </div>
    </ng-template>

    <!--------------------------------------------------------Messaging--------------------------------------------------->
    <!--     <mat-tab label="Messaging">

    </mat-tab>-->
    <!--------------------------------------------------------Financial--------------------------------------------------->

    <mat-tab label="Financials">
      <div class="container-fluid">
        <div class="container-fluid">
          <button mat-raised-button color="permit" (click)="openDocUpload(newSub)" [disabled]="fromReApplyArchive == true">Upload document</button>
          <!---- Financial POP Kyle 15/01/24-->
          <button *ngIf="applicationDataForView[0].ApplicationStatus == 'Unpaid' && uploadedPOP == false" (click)="openDocUpload(newSub);OnPOPUpload()" mat-raised-button color="permit" [disabled]="fromReApplyArchive == true">Upload Proof Of Payment</button>
          <!----Financial POP Kyle 15/01/24-->

        </div>


        <table mat-table [dataSource]="dataSourceDoc" class="mat-elevation-z8">


          <ng-container matColumnDef="FinancialName">
            <th mat-header-cell *matHeaderCellDef> Name </th>
            <td mat-cell *matCellDef="let element"> {{element.FinancialType}} </td>
          </ng-container>

          <ng-container matColumnDef="FinancialDocumentName">
            <th mat-header-cell *matHeaderCellDef> Document Name </th>
            <td mat-cell *matCellDef="let element"> {{element.FinancialDocumentName}} </td>
          </ng-container>

          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let i = index">
              <button mat-raised-button color="blue" matTooltip="View" (click)="viewDocument(i)"><img src="assets/fontawesome-free-6.4.2-web/svgs/regular/eye-solid-white.svg" class="icon"></button>



            </td>
            <td mat-cell *matCellDef="let element">  </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>

        <div class="form-floating mb-3 mt-3" *ngIf="WBSField">
          <input type="text" class="form-control" id="wbsNumberRequested" placeholder="WBS Number" [(ngModel)]="wbsNumberRequested" readonly>
          <label for="wbsNumberRequested">WBS Number</label>
        </div>
        <div class="cont" *ngIf="isInternalUser">
          <button mat-raised-button (click)="enterWBSNumberModal(wbsNumberModal)" color="orange" *ngIf="WBSBtn">WBS</button>
          <button mat-raised-button color="orange" *ngIf="isEMBUser" (click)="generateConsolidatedDepositInvoice()">Consolidate Deposits</button>
          <button mat-raised-button color="orange" *ngIf="isEMBUser">Deposit Refund</button>
          <button mat-raised-button color="orange" *ngIf="isEMBUser" (click)="generateInvoiceSplit()">Invoice Split</button>
        </div>
        <!--        <input type="text" id="datePaid" placeholder="DatePaid" [(ngModel)]="datePaid" readonly>-->
        <div class="alert alert-info" role="alert" *ngIf="ExternalPaid">This application has been paid on the : {{Paid}}</div>

      </div>

    </mat-tab>


    <!--------------------------------------------------------Documents--------------------------------------------------->


    <mat-tab label="Documents Upload">

      <app-documents-component [ApplicationID]="ApplicationID"
                               [ServiceConditionActive]="false">

      </app-documents-component>

    </mat-tab>






    <!------------------------------------------------------------Packs---------------------------------------------------------->
    <!--JJS Commit 20-02-24-->
    <!--    <mat-tab label="Packs" *ngIf="PacksTab">
        <app-approval-pack [ApplicationID]="ApplicationID"
                           [ServiceConditionActive]="false"></app-approval-pack>
      </mat-tab>-->
    <!--------------------------------------------------------Applicant--------------------------------------------------->

    <mat-tab label="Applicant">

      <!-- icasaDetailsDisplay Sindiswa 15 January 2024, an external applicant trying to look at their own application sees  the ORIGINATOR/APPLICANT thing for some reason!?? -->
      <!--External User information-->
      <div class="container-fluid" *ngIf="isInternal == false && theirProxy == false">

        <div class="row">
          <div class="col">
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="extApplicantBpNoApplicant" placeholder="Enter BP Number" disabled>
                <label for="bpNoApplicant">BP Number</label>
              </div>
            </div>
          </div>
          <div class="col">
            <div class="form-floating mb-3 mt-3">
              <input type="text" class="form-control" [(ngModel)]="extApplicantCompanyName" placeholder="Enter Company Name" disabled>
              <label for="address">Company Name</label>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col">
            <div class="form-floating mb-3 mt-3">
              <input type="text" class="form-control" [(ngModel)]="extApplicantCompanyRegNo" placeholder="Enter Company Reg No" disabled>
              <label for="address">Company Reg No.</label>
            </div>
          </div>
          <!-- icasaDetailsDisplay Sindiswa 15 January 2024 -->
          <div class="col" *ngIf="isTelecomms">
            <div class="form-floating mb-3 mt-3">
              <input type="text" class="form-control" [(ngModel)]="extApplicantICASALicense" placeholder="Enter ICASA License Number" disabled>
              <label for="address">ICASA License No.</label>
            </div>
          </div>
          <!-- endof icasaDetailsDisplay Sindiswa 15 January 2024 -->
          <div class="col">
            <div class="form-floating mb-3 mt-3">
              <input type="email" class="form-control" [(ngModel)]="extApplicantCompanyType" placeholder="Select Company Type" disabled>
              <label for="applicantEmail">Company Type</label>
            </div>
          </div>
        </div>


        <div class="row">
          <div class="col">
            <div class="form-floating mb-3 mt-3">
              <input type="text" class="form-control" [(ngModel)]="extApplicantName" placeholder="Enter First Name" disabled>
              <label for="name">Name</label>
            </div>
          </div>
          <div class="col">
            <div class="form-floating mb-3 mt-3">
              <input type="text" class="form-control" [(ngModel)]="extApplicantSurname" placeholder="Enter Surname" disabled>
              <label for="surname">Surname</label>
            </div>
          </div>
        </div>




        <div class="row">
          <div class="col">
            <div class="form-floating mb-3 mt-3">
              <input type="text" class="form-control" [(ngModel)]="extApplicantPhyscialAddress" placeholder="Enter Address" disabled>
              <label for="applicantTellNo">Physcial Address</label>
            </div>
          </div>
          <div class="col">
            <div class="form-floating mb-3 mt-3">
              <input type="tel" class="form-control" [(ngModel)]="extApplicantTellNo" placeholder="Enter Tell No." disabled>
              <label for="applicantTellNo">Cell No.</label>
            </div>

          </div>

        </div>
        <div class="row">


          <div class="form-floating mb-3 mt-3">
            <input type="email" class="form-control" [(ngModel)]="extApplicantEmail" placeholder="Enter Email" disabled>
            <label for="applicantEmail">Email</label>
          </div>

        </div>

      </div>



      <!--Internal user information-->
      <div class="container-fluid" *ngIf="isInternal == true && theirProxy == false">

        <div class="row">
          <div class="col">
            <div class="form-floating mb-3 mt-3">
              <input type="text" class="form-control" [(ngModel)]="internalApplicantName" placeholder="Enter First Name" disabled>
              <label for="name">Name</label>
            </div>
          </div>
          <div class="col">
            <div class="form-floating mb-3 mt-3">
              <input type="text" class="form-control" [(ngModel)]="internalApplicantSurname" placeholder="Enter Surname" disabled>
              <label for="surname">Surname</label>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col">
            <div class="form-floating mb-3 mt-3">
              <input type="text" class="form-control" [(ngModel)]="internalApplicantDirectorate" placeholder="Enter Surname" disabled>
              <label for="surname">Department</label>
            </div>
          </div>
          <div class="col">
            <div class="form-floating mb-3 mt-3">
              <input type="text" class="form-control" [(ngModel)]="internalApplicantBranch" placeholder="Enter Branch" disabled>
              <label for="Branch">Branch</label>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col">
            <div class="form-floating mb-3 mt-3">
              <input type="text" class="form-control" [(ngModel)]="internalApplicantCostCenterNo" placeholder="Enter Cost Center Number" disabled>
              <label for="costCenterNumber">Cost Center Number</label>
            </div>
          </div>
          <div class="col">
            <div class="form-floating mb-3 mt-3">
              <input type="text" class="form-control" [(ngModel)]="internalApplicantCostCenterOwner" placeholder="Enter Cost Center Owner" disabled>
              <label for="costCenterOwner">Cost Center Owner</label>
            </div>
          </div>
        </div>



      </div>

      <!--Having applied for another person-->
      <!-- <div *ngIf="internalProxy == true"> -->
      <div class="container-fluid" *ngIf="theirProxy == true">
        <br />
        <div class="centered-text">
          <div class="line left-line"></div>
          ORIGINATOR
          <div class="line right-line"></div>
        </div>
        <br />
        <div *ngIf="internalProxyApplicant == true">
          <div class="row">
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="internalProxyApplicantName" placeholder="Enter First Name" disabled>
                <label for="name">Name</label>
              </div>
            </div>
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="internalProxyApplicantSurname" placeholder="Enter Surname" disabled>
                <label for="surname">Surname</label>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="internalProxyApplicantDirectorate" placeholder="Enter Surname" disabled>
                <label for="surname">Department</label>
              </div>
            </div>
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="internalProxyApplicantBranch" placeholder="Enter Branch" disabled>
                <label for="Branch">Branch</label>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="internalProxyApplicantCostCenterNo" placeholder="Enter Cost Center Number" disabled>
                <label for="costCenterNumber">Cost Center Number</label>
              </div>
            </div>
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="internalProxyApplicantCostCenterOwner" placeholder="Enter Cost Center Owner" disabled>
                <label for="costCenterNumber">Cost Center Owner</label>
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="internalProxyApplicant == false">

          <div class="row">
            <div class="col">
              <div class="col">
                <div class="form-floating mb-3 mt-3">
                  <input type="text" class="form-control" [(ngModel)]="extProxyApplicantBpNoApplicant" placeholder="Enter BP Number" disabled>
                  <label for="bpNoApplicant">BP Number</label>
                </div>
              </div>
            </div>
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="extProxyApplicantCompanyName" placeholder="Enter Company Name" disabled>
                <label for="address">Company Name</label>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="extProxyApplicantCompanyRegNo" placeholder="Enter Company Reg No" disabled>
                <label for="address">Company Reg No.</label>
              </div>
            </div>
            <!-- icasaDetailsDisplay Sindiswa 15 January 2024 -->
            <div class="col" *ngIf="isTelecomms">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="extProxyApplicantICASALicense" placeholder="Enter ICASA License Number" disabled>
                <label for="address">ICASA License No.</label>
              </div>
            </div>
            <!-- endof icasaDetailsDisplay Sindiswa 15 January 2024 -->
          </div>


          <div class="row">
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="extProxyApplicantName" placeholder="Enter First Name" disabled>
                <label for="name">Name</label>
              </div>
            </div>
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="extProxyApplicantSurname" placeholder="Enter Surname" disabled>
                <label for="surname">Surname</label>
              </div>
            </div>
          </div>




          <div class="row">
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="extProxyApplicantPhyscialAddress" placeholder="Enter Address" disabled>
                <label for="applicantTellNo">Physcial Address</label>
              </div>
            </div>
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="tel" class="form-control" [(ngModel)]="extProxyApplicantTellNo" placeholder="Enter Tell No." disabled>
                <label for="applicantTellNo">Cell No.</label>
              </div>

            </div>

          </div>
          <div class="row">


            <div class="form-floating mb-3 mt-3">
              <input type="email" class="form-control" [(ngModel)]="extProxyApplicantEmail" placeholder="Enter Email" disabled>
              <label for="applicantEmail">Email</label>
            </div>

          </div>
        </div>
        <br />
        <div class="centered-text">
          <div class="line left-line"></div>
          APPLICANT
          <div class="line right-line"></div>
        </div>
        <div *ngIf="isExternalApplicant == false">
          <div class="row">
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="internalApplicantName" placeholder="Enter First Name" disabled>
                <label for="name">Name</label>
              </div>
            </div>
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="internalApplicantSurname" placeholder="Enter Surname" disabled>
                <label for="surname">Surname</label>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="internalApplicantDirectorate" placeholder="Enter Surname" disabled>
                <label for="surname">Department</label>
              </div>
            </div>
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="internalApplicantBranch" placeholder="Enter Branch" disabled>
                <label for="Branch">Branch</label>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="email" class="form-control" [(ngModel)]="internalApplicantCostCenterNo" placeholder="Enter Cost Center Number" disabled>
                <label for="applicantEmail">Cost Center Number</label>
              </div>
            </div>
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="internalApplicantCostCenterOwner" placeholder="Enter Cost Center Owner" disabled>
                <label for="applicantTellNo">Cost Center Owner</label>
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="isExternalApplicant">
          <div class="row">
            <div class="col">
              <div class="col">
                <div class="form-floating mb-3 mt-3">
                  <input type="text" class="form-control" [(ngModel)]="extApplicantBpNoApplicant" placeholder="Enter BP Number" disabled>
                  <label for="bpNoApplicant">BP Number</label>
                </div>
              </div>
            </div>
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="extApplicantCompanyName" placeholder="Enter Company Name" disabled>
                <label for="address">Company Name</label>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="extApplicantCompanyRegNo" placeholder="Enter Company Reg No" disabled>
                <label for="address">Company Reg No.</label>
              </div>
            </div>
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="email" class="form-control" [(ngModel)]="extApplicantCompanyType" placeholder="Select Company Type" disabled>
                <label for="applicantEmail">Company Type</label>
              </div>
            </div>
          </div>


          <div class="row">
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="extApplicantName" placeholder="Enter First Name" disabled>
                <label for="name">Name</label>
              </div>
            </div>
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="extApplicantSurname" placeholder="Enter Surname" disabled>
                <label for="surname">Surname</label>
              </div>
            </div>
          </div>




          <div class="row">
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="text" class="form-control" [(ngModel)]="extApplicantPhyscialAddress" placeholder="Enter Address" disabled>
                <label for="applicantTellNo">Physcial Address</label>
              </div>
            </div>
            <div class="col">
              <div class="form-floating mb-3 mt-3">
                <input type="tel" class="form-control" [(ngModel)]="extApplicantTellNo" placeholder="Enter Tell No." disabled>
                <label for="applicantTellNo">Cell No.</label>
              </div>

            </div>

          </div>
          <div class="row">


            <div class="form-floating mb-3 mt-3">
              <input type="email" class="form-control" [(ngModel)]="extApplicantEmail" placeholder="Enter Email" disabled>
              <label for="applicantEmail">Email</label>
            </div>

          </div>
        </div>
      </div>
    </mat-tab>

    <!--------------------------------------------------------Engineer--------------------------------------------------->

    <mat-tab label="Engineer">
      <div class="container-fluid">

        <!--  <app-new-egineer></app-new-egineer>-->
        <app-view-engineers-table [ApplicationID]="ApplicationID"></app-view-engineers-table>


      </div>





    </mat-tab>



    <!--------------------------------------------------------Contractor--------------------------------------------------->

    <mat-tab label="Contractor">

      <div class="container-fluid">


        <!--     <app-new-contractor></app-new-contractor>-->

        <app-view-contractors-table [ApplicationID]="ApplicationID"></app-view-contractors-table>
      </div>

    </mat-tab>


    <!--------------------------------------------------------Tracking--------------------------------------------------->
    <!-----Status of works Kyle 16-02-24-->
    <mat-tab label="Status of Works" *ngIf="showStatusOfWorksTab">

      <button mat-raised-button *ngIf="canCreateNote === true" color="permit" (click)="openXl(MFTModal)">Create New Note</button>
      <app-status-of-works [ApplicationID]="ApplicationID"></app-status-of-works>

    </mat-tab>



    <!--------------------------------------------------------Audit Trail--------------------------------------------------->


    <mat-tab label="Audit Trail" *ngIf="auditTrail">

      <app-audit-trail></app-audit-trail>

    </mat-tab>



    <!--------------------------------------------------------Permits--------------------------------------------------->

    <mat-tab label="Permits" *ngIf="showPermitTab">


      <button mat-raised-button color="permit" (click)=" getAllManDocForPTWStage(permitModal)" *ngIf="permitBtn" [disabled]="fromReApplyArchive == true">Apply For Permit</button>
      <br>
      <br>
      <input type="text" class="form-control" [(ngModel)]="permitDate" id="permitDate" *ngIf="permitTextBox" disabled>

      <ng-template #permitModal let-modal>
        <div class="modal-header">
          <h4 class="modal-title" id="modal-basic-title">Please select a date for your permit</h4>
          <button type="button" class="btn-close" aria-label="Close" (click)=" ClosePermitStartDateModal()"></button>
        </div>
        <div class="modal-body">



          <div class="row">

            <div class="form-floating mb-3 mt-3">
              <input type="date" class="form-control" [(ngModel)]="permitStartDate" id="permitStartDate" [min]="minDate" placeholder="Enter the start date for the permit">
              <label for="permitStartDate">Select Start Date</label>
            </div>

          </div>

          <mat-list *ngFor="let manDoc of  MandatoryDocumentUploadList ; let i = index">
            <mat-list-item> {{manDoc.mandatoryDocumentName}}</mat-list-item>
            <mat-form-field class="manDoc" >
              <div>
                <mat-toolbar>
                  <!-- Display files names -->
                  <input matInput readonly name="name" class="textFuckingBox" /> <!--[(ngModel)]="fileAttrs[i]"-->
                  <!-- app-file-upload Component -->

                  <div class="container-fluid">
                    <app-file-upload [ApplicationID]="ApplicationID"
                                     [UploadFor]="manDoc.mandatoryDocumentName"
                                     (passFileName)="onPassFileName($event)"
                                     (onUploadFinished)="onFileDelete2($event,i)"
                                     (onUploadSuccess)="onFileUpload2($event,i)">
                    </app-file-upload>
                  </div>
                  <button mat-raised-button color="blue2"  *ngIf="manDoc.hasFile === true" matTooltip="View Document"><img src="assets/fontawesome-free-6.4.2-web/svgs/regular/eye-solid.svg" class="icon blue"></button>
                </mat-toolbar>
               
              </div>
            </mat-form-field>
          </mat-list>



        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-success" [disabled]="fileCount !== MandatoryDocumentUploadList.length || permitStartDate === null || permitStartDate === undefined " (click)="updateStartDateForPermit();modal.close('Save click')">Save</button>
        </div>
      </ng-template>
      <!--Permit Kyle 13-02-24-->
      <app-permit-component [ApplicationID]="ApplicationID" [ApplicantID]="CurrentApplicationBeingViewed[0].UserID" [OriginatorID]="CurrentApplicationBeingViewed[0].CreatedById" [ApplicationID]="ApplicationID" [PermitBtn]="permitBtn"></app-permit-component>

    </mat-tab>

    <!--<mat-tab label="Process Flow" *ngIf="auditTrail">



    </mat-tab>-->
    <!--------------------------------------------------------Service Condtions---------------------------------------------->
    <mat-tab label="Service Conditions">

      <app-service-conditions [ApplicationID]="ApplicationID"
                              [ServiceConditionActive]="true">

      </app-service-conditions>

    </mat-tab>
    <!--Old versions of wayleave application--------------------------------------------------------------------------------->
    <mat-tab label="Former Wayleave Applications" *ngIf="showFormerApps == true">
      <app-old-application-versions></app-old-application-versions>
    </mat-tab>
  </mat-tab-group>



</div>



<!--This is for the wbs number-->

<ng-template #wbsNumberModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title">WBS Number</h4>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <div class="modal-body">
    <form [formGroup]="addWBSNumber">
      <div class="form-floating mb-3 mt-3">
        <input type="text" class="form-control" formControlName="wbsnumber" placeholder="wbsnumber">
        <label for="wbsnumber">WBS Number</label>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button type="submit" class="btn btn-outline-success" (click)="onCreateWBSNumber();modal.close('Save click')">Save</button>
  </div>
</ng-template>

<ng-template #newSub let-modal>
  <div class="modal-header">
    <h4 class="modal-title">Upload Document: Please name your files in a clear and descriptive manner to assist the reviewer. Thank you!</h4>
    <button type="button" class="btn-close" aria-label="Close" (click)="onCloseFile()"></button>
  </div>
  <div class="modal-body">
    <form>
      <mat-form-field>
        <!-- Display files names -->
        <input matInput [(ngModel)]="fileAttrs" readonly name="name" />
        <!-- app-file-upload Component -->
        <div class="row" style="margin-bottom:15px;">
          <div class="container-fluid">
            <!-- Financial POP Kyle 15/01/24-->
            <app-file-upload [ApplicationID]="ApplicationID"
                             [UploadFor]="fileAttrsName"
                             [isFinancial]="isFinancial"
                             [uploadingPOP]="uploadingPOP"
                             (passFileName)="onPassFileName($event)"
                             (onUploadFinished)="onFileDelete($event, 0)"
                             (onUploadSuccess)="onFileUpload($event)">
            </app-file-upload>
          </div>
        </div>
      </mat-form-field>
    </form>
  </div>
  <div class="modal-footer">
    <button type="submit" class="btn btn-outline-success" (click)="getFinancial();changeHasFile();modal.close('Close click')">Save</button>
  </div>
</ng-template>


<ng-template #paidDateModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Please select the date client paid fot this application</h4>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <div class="modal-body">



    <div class="row">

      <div class="form-floating mb-3 mt-3">
        <input type="date" class="form-control" [(ngModel)]="selectPaidDate" id="selectPaidDate" placeholder="Enter the date this application was paid for...">
        <label for="selectPaidDate">Select Paid Date</label>
      </div>

    </div>



  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-success" (click)="ChangeApplicationStatusToPaid();modal.close('Save click')">Save</button>
  </div>
</ng-template>
<!--FAQ-->
<!--  //JJS Approval Pack and rejection pack 25Jan2024-->
<!--JJS - Changed the approval packing loading screen to match the other loading screens-->
<!--  <div class="loading-screen" id="loadingScreen">
    <mat-spinner></mat-spinner>

  </div>-->
<div class="loading-screen" *ngIf="isLoading" id="loadingScreen">
  <img src="assets/Loading.png" alt="" class="logo2">
  <div class="text">Generating Approval Pack</div>
  <div class="text2">This may take several minutes</div>
</div>


<!-- Example template -->

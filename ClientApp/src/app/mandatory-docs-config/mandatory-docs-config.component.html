<!--modal to create a new doc-->

<ng-template #content let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Creating a document upload</h4>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <div class="modal-body">
    <form [formGroup]="addManDoc">


      <div class="row">

        <div class="form-floating mb-3 mt-3">
          <input type="text" class="form-control" id="newManDocName" formControlName="newManDocName" placeholder="Enter the Doc upload name">
          <label for="newManDocName">Document upload Name/Instruction</label>
        </div>

      </div>

      <div class="row">
        <mat-form-field appearance="fill">
          <mat-label>Select type of application</mat-label>
          <mat-select formControlName="mandatoryDocumentCategory" name="mandatoryDocumentCategory">
            <mat-option value="">Other</mat-option>
            <mat-option value="Small">Small</mat-option>
            <mat-option value="Medium">Medium</mat-option>
            <mat-option value="Large">Large</mat-option>
            <mat-option value="Emergency">Emergency</mat-option>


          </mat-select>
        </mat-form-field>

      </div>

      <!--<div class="form-floating mb-3 mt-3">
        <input type="text" class="form-control" id="mandatoryDocumentCategory" formControlName="mandatoryDocumentCategory" placeholder="Mandatory Document Category">
        <label for="mandatoryDocumentCategory">Mandatory Document Category</label>
      </div>-->


      


    </form>


  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-success" (click)="onManDocCreate();modal.close('Save click')">Save</button>
  </div>
</ng-template>
<!--end of modal-->


<div class="container-fluid">

  <button mat-raised-button color="create" (click)="openXl(content)">Create a new document upload </button>

  <mat-form-field>
    <mat-label>Filter By Category</mat-label>
    <mat-select name="manDocCategory" [(ngModel)]="manDocCategory">
      <mat-option (click)="setFilterManDocCategory()" value="Small">Small</mat-option>
      <mat-option (click)="setFilterManDocCategory()" value="Medium">Medium</mat-option>
      <mat-option (click)="setFilterManDocCategory()" value="Large">Large</mat-option>
      <mat-option (click)="setFilterManDocCategory()" value="Emergency">Emergency</mat-option>
      <mat-option (click)="setFilterManDocCategory()" value="LUM">LUM</mat-option>
    </mat-select>
  </mat-form-field>
  <!--display all docs -->
    <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">

    <ng-container matColumnDef="mandatoryDocumentName">
      <th mat-header-cell *matHeaderCellDef >Document Uploads </th>
      <td mat-cell *matCellDef="let element" > {{element.mandatoryDocumentName}} </td>
    </ng-container>
    <ng-container matColumnDef="mandatoryDocumentCategory">
      <th mat-header-cell *matHeaderCellDef style="width: 10%;">Document Category </th>
      <td mat-cell *matCellDef="let element"> {{element.mandatoryDocumentCategory}} </td>
    </ng-container>
    <ng-container matColumnDef="dateCreated">
      <th mat-header-cell *matHeaderCellDef>Date Created </th>
      <!--<td mat-cell *matCellDef="let element"> {{element.dateCreated}} </td>-->
      <!--South Africa time is South African Standard Time is UTC+2-->
      <td mat-cell *matCellDef="let element"> {{element.dateCreated | date:'yyyy-MM-dd HH:mm:ss' }} </td>
  <!--  <td mat-cell *matCellDef="let element"> {{getSouthAfricanTime(element.dateCreated) | date:'yyyy-MM-dd HH:mm:ss' }} </td>-->
    </ng-container>


    <ng-container matColumnDef="actions"  class="button-container">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let i = index">
        <button mat-raised-button color="success" (click)=" getCurrentMandatoryDocID(i);openAddUserToAccessGroup(addStage)"><i class="fa fa-plus"></i></button>
        <button mat-raised-button color="orange" (click)=" getCurrentMandatoryDocID(i); openEdit(editingManDoc, i)"><i class="fa fa-pencil"></i></button>
        <button mat-raised-button color="blue" (click)=" getCurrentMandatoryDocID(i);getAllLinkedStages(i,viewLinkedStages)"><i class="fa fa-eye"></i></button>
        <button mat-raised-button color="warn" (click)=" getCurrentMandatoryDocID(i);onManDocDelete(i)"><i class="fa fa-trash"></i></button>

      </td>
      <td mat-cell *matCellDef="let element">  </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
  </div>

  <!--modal to add stages to mandatory doc-->

    <ng-template #addStage let-modal>
      <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Select the stage to apply this document upload</h4>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
      </div>
      <div class="modal-body">
        <form>
          <div class="container-fluid">
            <table mat-table [dataSource]="dataSourceAddStage" class="mat-elevation-z8">


              <ng-container matColumnDef="StageName">
                <th mat-header-cell *matHeaderCellDef> Stage name </th>
                <td mat-cell *matCellDef="let element"> {{element.StageName}} </td>
              </ng-container>


              <ng-container matColumnDef="actions">
                <th mat-header-cell *matHeaderCellDef>Select</th>
                <td mat-cell let i=index *matCellDef="let element">

                  <mat-checkbox class="example-margin" (change)="stageSelectedForLink(element)"></mat-checkbox>
                </td>

              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumnsAddStage"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumnsAddStage;"></tr>
            </table>


          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-success" (click)="onStageLink();modal.close('Save click')">Save</button>
      </div>
    </ng-template>

    <!--end-->
    <!--modal to add stages to mandatory doc-->

    <ng-template #viewLinkedStages let-modal>
      <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Viewing all linked stages for {{header}}</h4>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
      </div>
      <div class="modal-body">
        <form>
          <div class="container-fluid">
            <table mat-table [dataSource]="dataSourceViewLinkedStages" class="mat-elevation-z8">


              <ng-container matColumnDef="stageName">
                <th mat-header-cell *matHeaderCellDef> Stage name </th>
                <td mat-cell *matCellDef="let element"> {{element.stageName}} </td>
              </ng-container>

              <ng-container matColumnDef="dateCreated">
                <th mat-header-cell *matHeaderCellDef> Date Created</th>
                <td mat-cell *matCellDef="let element"> {{element.dateCreated}} </td>
              </ng-container>

              <ng-container matColumnDef="actions">
                <th mat-header-cell *matHeaderCellDef>Actions</th>
                <td mat-cell *matCellDef="let i = index">

                  <button mat-raised-button color="warn" (click)="modal.close('Close click');onStageDelete(i,viewLinkedStages)"><i class="fa fa-trash" aria-hidden="true"></i></button>
                </td>

              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumnsViewLinkedStages"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumnsViewLinkedStages;"></tr>
            </table>


          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-success" (click)="modal.close('Save click')">Save</button>
      </div>
    </ng-template>

    <!--end-->
    <!--modal to edit madatory doc-->
    <ng-template #editingManDoc let-modal>
      <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Editing an existing document upload</h4>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="editManDoc">


          <div class="row">

            <div class="form-floating mb-3 mt-3">
              <input type="text" class="form-control" id="editManDocName" formControlName="editManDocName" placeholder="Enter the Doc upload name">
              <label for="editManDocName">Document upload Name/Instruction</label>
            </div>

          </div>

          <div class="row">
            <mat-form-field appearance="fill">
              <mat-label>Select type of application</mat-label>
              <mat-select formControlName="editManDocCategory" name="editManDocCategory">
                <mat-option value="">Other</mat-option>
                <mat-option value="Small">Small</mat-option>
                <mat-option value="Medium">Medium</mat-option>
                <mat-option value="Large">Large</mat-option>
                <mat-option value="Emergency">Emergency</mat-option>


              </mat-select>
            </mat-form-field>

          </div>
        </form>


      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-success" (click)=" onManDocEdit();modal.close('Save click')">Save</button>
      </div>
    </ng-template>
    <!--end-->
